<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script src="/cdn-cgi/apps/head/3cOPSgo5Omz84ycX7CvigfX4cpw.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82213539-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-82213539-2');
    </script>
    <title>3 Sending Email 4.0.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Grails Mail Plugin
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/1.%20Introduction.html"><strong>1</strong><span>Introduction</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/2.%20Configuration.html"><strong>2</strong><span>Configuration</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/3.%20Sending%20Email.html"><strong>3</strong><span>Sending Email</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/4.%20Testing.html"><strong>4</strong><span>Testing</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/2.%20Configuration.html">&lt;&lt; <strong>2</strong><span>Configuration</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/4.%20Testing.html"><strong>4</strong><span>Testing</span> >></a></div>
                


                <div class="project">
                    <h1>3 Sending Email</h1>

                    <p><strong>Version:</strong> 4.0.0</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.1%20Sender%20And%20Recipient"><strong>3.1</strong><span>Sender And Recipient</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.2%20Message%20Content"><strong>3.2</strong><span>Message Content</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#3.3%20Attachments"><strong>3.3</strong><span>Attachments</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="3. Sending Email">3 Sending Email</h1>


Mail is sent using the <code>sendMail()</code> method of the <code>mailService</code>. This plugin also adds a shortcut <code>sendMail()</code> method to all controllers and services in your application that simply delegates to the <code>mailService</code>. There is no difference between the two methods so the choice is stylistic.<p class="paragraph"/><div class="code"><pre>class PersonController &#123;<p class="paragraph"/>    def create = &#123;
        // create user<p class="paragraph"/>        sendMail &#123;
            from <span class="java&#45;quote">"admin@mysystem.com"</span>
            subject <span class="java&#45;quote">"New user"</span>
            text <span class="java&#45;quote">"A <span class="java&#45;keyword">new</span> user has been created"</span>
        &#125;
    &#125;
&#125;</pre></div><p class="paragraph"/>The <code>sendMail()</code> method takes a single <code>Closure</code> argument that uses a DSL to configure the message to be sent. This section describes the aspects of the DSL.<p class="paragraph"/><div class="code"><pre>class PersonController &#123;<p class="paragraph"/>    def mailService<p class="paragraph"/>    def create = &#123;
        // create user<p class="paragraph"/>        mailService.sendMail &#123;
            from <span class="java&#45;quote">"admin@mysystem.com"</span>
            subject <span class="java&#45;quote">"New user"</span>
            text <span class="java&#45;quote">"A <span class="java&#45;keyword">new</span> user has been created"</span>
        &#125;
    &#125;
&#125;</pre></div>



<h2 id="3.1 Sender And Recipient">3.1 Sender And Recipient</h2>


<h3>Recipients</h3><p class="paragraph"/>The DSL provides <code>to</code>, <code>cc</code> and <code>bcc</code> methods that allow you to set one or more address values for these recipient types.<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"someone@org.com"</span>
    cc <span class="java&#45;quote">"manager@org.com"</span>
    bcc <span class="java&#45;quote">"employee1&#64;org.com"</span>, <span class="java&#45;quote">"employee2&#64;org.com"</span>
    …
&#125;</pre></div><p class="paragraph"/>All methods take one or more string values that are an email address using the syntax of <a href="http://www.ietf.org/rfc/rfc822.txt." target="blank">RFC822</a> Typical address syntax is of the form <code>"user&#64;host.domain"</code> or <code>"Personal Name &#60;user&#64;host.domain&#62;"</code>.<p class="paragraph"/>You can supply multiple values for <code>to</code>, <code>cc</code> and <code>bcc</code>.<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"someone@org.com"</span>, <span class="java&#45;quote">"someone.<span class="java&#45;keyword">else</span>&#64;org.com"</span>
    …
&#125;</pre></div><p class="paragraph"/>If no value is provided for <code>to</code> when sending an email, the  <em class="italic">default to address</em>  will be used.<p class="paragraph"/><blockquote class="warning">
If the configuration property <code>grails.mail.overrideAddress</code> is set, each recipient address specified will be substituted with the override address. See the configuration section for more information.
</blockquote><p class="paragraph"/><h3>Sender</h3><p class="paragraph"/>The sender address of the email is configured by the <code>from</code> method.<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    from <span class="java&#45;quote">"me&#64;org.com"</span>
    …
&#125;</pre></div><p class="paragraph"/>The <code>from</code> method accepts one string value email address using the syntax of <a href="http://www.ietf.org/rfc/rfc822.txt." target="blank">RFC822</a> Typical address syntax is of the form <code>"user&#64;host.domain"</code> or <code>"Personal Name &#60;user&#64;host.domain&#62;"</code>.<p class="paragraph"/>If no value is provided for <code>from</code> when sending an email, the  <em class="italic">default from address</em>  will be used.


<h2 id="3.2 Message Content">3.2 Message Content</h2>


Message content is specified by either the <code>text</code> and/or <code>html</code> methods that specify either the plain text or HTML content respectively.<p class="paragraph"/><blockquote class="note">
As of version 1.0, the <code>body</code> method that could be used to specify the message content has been deprecated (but is still there). The <code>body</code> method requires the user to specify the content type of the message using a GSP directive such as:<p class="paragraph"/>&#60;%&#64; page contentType="text/html" %&#62;
</blockquote><p class="paragraph"/><h3>HTML Email</h3><p class="paragraph"/>To send HTML mail you can use the <code>html</code> method. This will set the content type of the message to <code>text/html</code>.<p class="paragraph"/>You can either supply a string value…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"user@somewhere.org"</span>
    subject <span class="java&#45;quote">"Hello John"</span>
    html <span class="java&#45;quote">"&#60;b&#62;Hello&#60;/b&#62; World"</span>
&#125;</pre></div><p class="paragraph"/>Or a view to render to form the content…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"user@somewhere.org"</span>
    subject <span class="java&#45;quote">"Hello John"</span>
    html view: <span class="java&#45;quote">"/emails/hello"</span>, model: &#91;param1: <span class="java&#45;quote">"value1"</span>, param2: <span class="java&#45;quote">"value2"</span>&#93;
&#125;</pre></div><p class="paragraph"/>See the section on using views for more details of the parameters to this version of <code>html</code>.<p class="paragraph"/><h3>Plain Text Email</h3><p class="paragraph"/>To send plain text mail you can use the <code>text</code> method. This will set the content type of the message to <code>text/plain</code>.<p class="paragraph"/>You can either supply a string value…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"user@somewhere.org"</span>
    subject <span class="java&#45;quote">"Hello John"</span>
    text <span class="java&#45;quote">"Hello World"</span>
&#125;</pre></div><p class="paragraph"/>Or a view to render to form the content…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"user@somewhere.org"</span>
    subject <span class="java&#45;quote">"Hello John"</span>
    text view: <span class="java&#45;quote">"/emails/hello"</span>, model: &#91;param1: <span class="java&#45;quote">"value1"</span>, param2: <span class="java&#45;quote">"value2"</span>&#93;
&#125;</pre></div><p class="paragraph"/>See the section on using views for more details of the parameters to this version of <code>text</code>.<p class="paragraph"/><h3>Plain Text <strong class="bold">and</strong> HTML</h3><p class="paragraph"/>It is possible to send a multipart message that contains both plain text and HTML versions of the message. In this situation, the mail reading client is responsible for selecting the variant to display to the user.<p class="paragraph"/>To do this, simply use both the <code>html</code> and <code>text</code> methods…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    to <span class="java&#45;quote">"user@somewhere.org"</span>
    subject <span class="java&#45;quote">"Hello John"</span>
    text view: <span class="java&#45;quote">"/emails/text&#45;hello"</span>, model: &#91;param1: <span class="java&#45;quote">"value1"</span>, param2: <span class="java&#45;quote">"value2"</span>&#93;
    html view: <span class="java&#45;quote">"/emails/html&#45;hello"</span>, model: &#91;param1: <span class="java&#45;quote">"value1"</span>, param2: <span class="java&#45;quote">"value2"</span>&#93;
&#125;</pre></div><p class="paragraph"/><h3>Using Views</h3><p class="paragraph"/>Both the <code>text</code> and <code>html</code> methods support specifying a view to render to form the content. These are the accepted parameters:
<ul class="star">
<li>The  <em class="italic">view</em>  is the absolute path (or relative to the current controller if during a request) to the GSP, just like the existing Grails <code>render</code> method.</li>
<li>The  <em class="italic">plugin</em>  parameter is only necessary if the  view you wish to render comes from a plugin, just like the existing Grails <code>render</code> method.</li>
<li>The  <em class="italic">model</em>  parameter is a map representing the model the GSP will see for rendering data, just like the existing Grails <code>render</code> method.</li>
</ul><p class="paragraph"/>


<h2 id="3.3 Attachments">3.3 Attachments</h2>


The mail plugin is capable of adding attachments to messages as independent files and inline resources. To enable attachment support, you <strong class="bold">MUST</strong> indicate that the message is to be  <em class="italic">multipart</em>  as the <strong class="bold">first</strong> thing you do in the mail DSL.<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    multipart <span class="java&#45;keyword">true</span>
&#125;</pre></div><p class="paragraph"/><h3>File Attachments</h3><p class="paragraph"/>The term file attachments here refers to the attachment being received as a file, not necessarily using a file in your application to form the attachment.<p class="paragraph"/>The following methods are available in the mail DSL to attach files…<p class="paragraph"/><div class="code"><pre>// Bytes
attach(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, <span class="java&#45;object">byte</span>&#91;&#93; bytes)<p class="paragraph"/>// Files
attach(File file)
attach(<span class="java&#45;object">String</span> fileName, File file)
attach(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, File file)<p class="paragraph"/>// InputStream
attach(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, InputStreamSource source)</pre></div><p class="paragraph"/>There are 3 things that need to be provided when creating a file attachment:
<ul class="star">
<li>file name - what the email client will call the file</li>
<li>content type - what mime type the email client will treat the file as</li>
<li>content source - the actual attachment</li>
</ul><p class="paragraph"/>The mail plugin supports using either a <code>byte&#91;&#93;</code>, <code>File</code>, or <a href="http://static.springsource.org/spring/docs/current/api/org/springframework/core/io/InputStreamSource.html" target="blank"><code>InputStreamSource</code></a> as the content source.<p class="paragraph"/>In the case of the variants that take a <code>File</code> that do not specify a file name, the name of the file will be used.<p class="paragraph"/>In the case of the variants that take a <code>File</code> that do not specify a content type, the content type will be guessed based on the file extension.<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    multipart <span class="java&#45;keyword">true</span>
    to <span class="java&#45;quote">"someone@org.com"</span>
    attach <span class="java&#45;quote">"yourfile.txt"</span>, <span class="java&#45;quote">"text/plain"</span>, <span class="java&#45;quote">"Hello!"</span> as <span class="java&#45;object">byte</span>&#91;&#93;
&#125;</pre></div><p class="paragraph"/><h3>Inline Attachments</h3><p class="paragraph"/>It is also possible to attach content as inline resources. This is particularly useful in the case of html email where you wish to embed images in the message. In this case you specify a  <em class="italic">content id</em>  instead of a file name for the attachment and then reference this content id in your mail message.<p class="paragraph"/>To attach an image as an inline resource you could do…<p class="paragraph"/><div class="code"><pre>sendMail &#123;
    multipart <span class="java&#45;keyword">true</span>
    to <span class="java&#45;quote">"someone@org.com"</span>
    inline <span class="java&#45;quote">"logo"</span>, <span class="java&#45;quote">"image/jpeg"</span>, <span class="java&#45;keyword">new</span> File(<span class="java&#45;quote">"logo.jpg"</span>)
    html view: <span class="java&#45;quote">"/email/welcome"</span>
&#125;</pre></div><p class="paragraph"/>Then in your view you reference the inline attachment using the <code>cid:</code> (content id) namespace…<p class="paragraph"/><div class="code"><pre>&#60;html&#62;
  &#60;body&#62;
    &#60;img src='cid:logo' /&#62;
    &#60;p&#62;Welcome Aboard!&#60;/p&#62;
  &#60;/body&#62;
&#60;/html&#62;</pre></div><p class="paragraph"/>The following methods are available in the mail DSL to attach files…<p class="paragraph"/><div class="code"><pre>// Bytes
inline(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, <span class="java&#45;object">byte</span>&#91;&#93; bytes)<p class="paragraph"/>// Files
inline(File file)
inline(<span class="java&#45;object">String</span> fileName, File file)
inline(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, File file)<p class="paragraph"/>// InputStream
inline(<span class="java&#45;object">String</span> fileName, <span class="java&#45;object">String</span> contentType, InputStreamSource source)</pre></div><p class="paragraph"/>There are 3 things that need to be provided when creating an inline attachment:
<ul class="star">
<li>content id - the identifier of the resource</li>
<li>content type - what mime type the email client will treat the content as</li>
<li>content source - the actual content</li>
</ul><p class="paragraph"/>The mail plugin supports using either a <code>byte&#91;&#93;</code>, <code>File</code>, or <a href="http://static.springsource.org/spring/docs/current/api/org/springframework/core/io/InputStreamSource.html" target="blank"><code>InputStreamSource</code></a> as the content source.<p class="paragraph"/>In the case of the variants that take a <code>File</code> that do not specify a content id, the name of the file will be used.<p class="paragraph"/>In the case of the variants that take a <code>File</code> that do not specify a content type, the content type will be guessed based on the file extension.


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/2.%20Configuration.html">&lt;&lt; <strong>2</strong><span>Configuration</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/4.%20Testing.html"><strong>4</strong><span>Testing</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
